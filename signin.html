<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Sign In</title>
<style>
  html,body{height:100%;margin:0;}
  body{
    font-family:"Segoe UI",Roboto,Arial,sans-serif;
    display:flex; justify-content:center; align-items:center;
    height:100vh;
    background:linear-gradient(180deg,#0f355b 0%,#071a33 100%);
    position:relative; overflow:hidden;
  }
  body::before{
    content:""; position:absolute; inset:0;
    background-image:url("https://upload.wikimedia.org/wikipedia/commons/4/46/Bitcoin.svg");
    background-repeat:repeat; background-size:150px;
    opacity:0.04; z-index:0; filter:blur(0.5px);
  }
  .card{
    position:relative; z-index:1;
    width:380px; max-width:calc(100vw - 40px);
    background:linear-gradient(180deg,rgba(6,20,40,0.95),rgba(7,18,34,0.92));
    border-radius:24px; padding:30px 24px;
    box-shadow:0 14px 40px rgba(2,6,23,0.7);
    color:#fff;
  }
  .title{text-align:center;margin-bottom:6px;font-weight:800;font-size:26px;text-transform:uppercase;}
  .subtitle{text-align:center;color:rgba(255,255,255,0.75);font-size:14px;margin-bottom:18px;}
  .field{margin-bottom:14px;}
  label{display:block;color:rgba(255,255,255,0.6);font-size:15px;margin-bottom:6px;font-weight:600;}
  .input{
    width:100%; padding:14px 16px; border-radius:12px;
    border:1px solid rgba(255,255,255,0.08); background:rgba(255,255,255,0.03);
    color:#e9f5ff; font-size:15px; outline:none;
  }
  .input::placeholder{color:rgba(255,255,255,0.45);}

  .forgot{
    text-align:center;
    margin-top:4px;
    margin-bottom:18px;
  }
  .forgot a{
    color:rgba(255,255,255,0.55);
    font-size:14px;
    text-decoration:none;
    transition:0.2s ease;
  }
  .forgot a:hover{
    color:#7fc4ff;
    text-decoration:underline;
  }

  .btn{
    width:100%; padding:16px; margin-top:10px; border-radius:12px;
    border:none; cursor:pointer; font-weight:800; font-size:18px;
    background:linear-gradient(90deg,#ffd400,#ffcf00); color:#111;
    box-shadow:0 6px 18px rgba(0,0,0,0.4);
  }
  .signup-line{text-align:center;margin-top:16px;color:rgba(255,255,255,0.85);font-size:15px;}
  .signup-line a{color:#7fc4ff;font-weight:700;text-decoration:none;}

  .toast{
    position:fixed;top:20px;right:20px;padding:12px 18px;border-radius:8px;
    color:#fff;font-size:15px;font-weight:500;z-index:9999;
    box-shadow:0 3px 12px rgba(0,0,0,0.35);
    animation:fadeIn .3s ease;
  }
  @keyframes fadeIn{from{opacity:0;transform:translateY(-6px);}to{opacity:1;transform:translateY(0);}}
</style>
</head>
<body>
  <div class="card">
    <div class="title">Sign In</div>
    <div class="subtitle">Welcome back to CYPX Online Crypto</div>

    <form id="signinForm" autocomplete="off" novalidate>
      <div class="field">
        <label for="email">Email</label>
        <input id="email" class="input" type="email" placeholder="Enter your email" required />
      </div>

      <div class="field">
        <label for="password">Password</label>
        <input id="password" class="input" type="password" placeholder="Enter your password" required />
      </div>

      <div class="forgot">
        <a href="#" id="forgotPasswordBtn">Forgot Password?</a>
      </div>

      <button class="btn" type="submit">Login</button>
    </form>

    <div class="signup-line">Don’t have an account? <a href="signup.html">Create Account</a></div>
  </div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";
import { 
  getAuth, 
  signInWithEmailAndPassword,
  sendPasswordResetEmail
} from "https://www.gstatic.com/firebasejs/10.12.3/firebase-auth.js";
import { getDatabase, ref, get, child } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyCCW4G9JlVu_xb0bGjlKmsi5mdqXSwvFak",
  authDomain: "quantum-rio.firebaseapp.com",
  databaseURL: "https://quantum-rio-default-rtdb.firebaseio.com",
  projectId: "quantum-rio",
  storageBucket: "quantum-rio.appspot.com",
  messagingSenderId: "805433999377",
  appId: "1:805433999377:web:d0efa8c46ec4a0fa30f1b0"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getDatabase(app);

function showToast(msg, success=false){
  const t=document.createElement("div");
  t.className="toast";
  t.style.background=success?"#28a745":"#ff4d4f";
  t.textContent=msg;
  document.body.appendChild(t);
  setTimeout(()=>t.remove(),4000);
}

document.getElementById("signinForm").addEventListener("submit", async e=>{
  e.preventDefault();
  const email=document.getElementById("email").value.trim();
  const password=document.getElementById("password").value.trim();

  if(!email || !password){
    showToast("Please enter email and password");
    return;
  }

  try{
    const cred = await signInWithEmailAndPassword(auth,email,password);
    const user = cred.user;

    const snap = await get(child(ref(db),"users/"+user.uid));
    if(!snap.exists()){
      showToast("User profile not found in database.");
      return;
    }

    showToast("Login successful!", true);
    setTimeout(()=> window.location.href="dashboard.html", 1200);

  }catch(err){
    console.error(err);

    // ⭐ Updated error messages as you requested
    if(err.code === "auth/wrong-password"){
      showToast("Wrong password");
    }
    else if(err.code === "auth/user-not-found"){
      showToast("Email is not registered");
    }
    else{
      showToast("Something went wrong, try again.");
    }
  }
});


// ⭐ Forgot Password
document.getElementById("forgotPasswordBtn").addEventListener("click", async ()=>{
  const email = document.getElementById("email").value.trim();

  if(!email){
    showToast("Enter your email to reset password.");
    return;
  }

  try{
    await sendPasswordResetEmail(auth, email);
    showToast("Reset link sent to your email!", true);
  }
  catch(err){
    console.error(err);
    if(err.code==="auth/user-not-found") showToast("Email is not registered");
    else showToast("Failed to send reset link.");
  }
});
</script>
</body>
</html>
